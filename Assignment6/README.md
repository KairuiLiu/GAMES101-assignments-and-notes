## Assignment 6

- 实现光线生成与光线映射

- 实现光线与三角形相交判断

- 判断点与Bounding Box相交

- 计算光线与曲面距离

- 实现SAH加速

  SAH认为光线穿透一个节点的概率与其表面积成比例. 将子BoundingBox作为一个整体, 程序总性能消耗期望应该是每个子节点消耗加权被选中的概率均值$C=C_{traw}+p_xC_{x}+p_yC_{y}$(认为$C_{traw}$是常数). 总期望消耗中, 子区域消耗可以表示为元素数量*元素表面积. 
  $$
  C=C_{traw}+\|A\|\frac{S_A}{S}C_{isect}+\|B\|\frac{S_B}{S}p_yC_{isect}
  $$
  ($ C_{isect}$是判断射线与物体是否相交的花费)

  我们的目标就是最小化$C$. 可以每个几个点采样, 取消耗最小的$C$作为子区域分割点. 由于$C$是$U$形函数, 也可以三分实现.

  但是在本例子中SAH加速效果并不明显(加速$5.52\%$), 这可能是因为物体分布过于均衡, 导致的分割点与BVH选取的重心中点相近. 如果渲染的是一个空旷场地, 效果可能会好一些

**结果**

- BVH加速结构(1467s)

  ![](./result/BVH.png)
  
- SAH加速结构(1386s)

  ![](./result/SAH.png)

